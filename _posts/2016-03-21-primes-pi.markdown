---
layout: post
title:  "Primes, Pi, and Riemann Zeta, Oh My!"
date:   2016-03-21 16:56:00 -0700
---

Somebody showed me a formula for $$\pi$$ based on prime numbers that
was pretty cool. That got me thinking about other cool
results that relate number theory and $$\pi$$ in unexpected ways.
I figured they would make a nice short update.

As a disclaimer, I am not a math major, and my math education
stopped at the start of real analysis. I'm targeting this towards
the high school math contest audience. That means I won't assume anything
above calculus, but I will assume everything up to calculus, and I assume
people reading this are willing to look up unfamiliar terms on their own.


Relatively Prime Random Numbers
---------------------------------------------------------------------

Let $$a$$ and $$b$$ be two uniformly random natural numbers.
What is the probability $$a$$ and $$b$$ are relatively prime?

First off, this problem isn't that well formed. There are infinitely
many natural numbers, and it's unclear how we'd pick one of infinitely
many things. To be more formal, we should really state the problem
this way.

> Let $$P(n)$$ be the probability that two uniformly random
> natural numberes from $$1$$ to $$n$$ (inclusive) are relatively prime.
> What is $$\lim_{n\to\infty} P(n)$$?

(From now on I'll use $$P(\infty)$$ for the limit.)

Alright, we have a problem. Now what? First, let's get an expression
at all. We're good if $$a$$ and $$b$$ share no common factors. For this
to be true, for every prime $$p$$ at most one of $$a,b$$ can be divisible
by $$p$$. Equivalently, $$a$$ and $$b$$ are not both divisible by $$p$$.

Since we pick naturals uniformly at random, the probability a random
natural is divisible by $$p$$ is $$1/p$$. The probabillity both
numbers are divisible by $$p$$ must be $$1/p^2$$, giving the following.

$$
    P(\infty) = \left(1 - \frac{1}{2^2}\right)
                \left(1 - \frac{1}{3^2}\right)
                \left(1 - \frac{1}{5^2}\right)\cdots
              = \prod_{p\text{ prime}} \left(1 - \frac{1}{p^2}\right)
$$

Now, here's where you apply an interesting trick - take the reciprocal
of both sides.

$$
    \frac{1}{P(\infty)}
    = \frac{1}{1 - \frac{1}{2^2}}\cdot
      \frac{1}{1 - \frac{1}{3^2}}\cdot
      \frac{1}{1 - \frac{1}{5^2}}\cdots
$$

For each fraction, substitute an infinite series by using $$\frac{1}{1-r} = 1 + r + r^2 + \cdots$$.

$$
    \frac{1}{P(\infty)}
    = \prod_{p\text{ prime}} \left(
        1 + \frac{1}{p^2} + \frac{1}{p^4} + \frac{1}{p^6} + \cdots
    \right)
$$

Alright, now we're bringing in the number theory. I claim the right
hand side is the same as

$$
    \sum_{n=1}^\infty \frac{1}{n^2}
$$

Why is this true? Suppose we expanded out the product above.
Each term of the expansion is the product of some choice of terms,
one from every infinite series. For example, suppose we picked
$$1/2^2$$ from the first series, $$1/3^2$$ from the second,
and $$1$$ from the rest. That term would be

$$
    \frac{1}{2^2\cdot 3^2} = \frac{1}{6^2}
$$

Now, suppose we picked $$1/2^4$$ from the $$2$$ series,
$$1$$ from the $$3$$ series, $$1/5^2$$ from the $$5$$ series, and
$$1$$ from the rest. That gives.

$$
    \frac{1}{2^4 \cdot 5^2} = \frac{1}{(2^2 \cdot 5)^2} = \frac{1}{20^2}
$$

That's the pattern. Now consider the term $$1/n^2$$. To construct that
term, find the prime factorization of $$n$$. Then, for every prime
$$p_i$$, find the power $$p_i^{k_i}$$ that divides $$n$$. ($$k_i$$ could be $$0$$.)
For the infinite series corresponding to $$p_i$$, take the term
$$1/p^{2k_i}$$. The product of all of those will be

$$
    \prod_{p\text{ prime}} \frac{1}{p^{2k_i}} = \frac{1}{\left(\prod_{p\text{ prime}} p^{k_i}\right)^2} = \frac{1}{n^2}
$$

Every natural number has a unique prime factorization. So, when the product

$$
    \prod_{p\text{ prime}} \left(
        1 + \frac{1}{p^2} + \frac{1}{p^4} + \frac{1}{p^6} + \cdots
    \right)
$$

is expanded, the term $$\frac{1}{n^2}$$ will be generated for every $$n$$,
and will be generated exactly once. Thus, the product is exactly the sum
of the reciprocal of the squares.

(If you're like me, you may want to spend a moment admiring the beauty and
elegance of this argument. This is a contender for my favorite proof ever.)

This reduces the problem to

$$
    \frac{1}{P(\infty)} = \sum_{n=1}^\infty \frac{1}{n^2}
$$

This series converges to $$\pi^2/6$$, giving

$$
    \Pr[\text{two numbers relatively prime}] = P(\infty) = \frac{6}{\pi^2} \approx 0.608
$$


Riemann Zeta With Copious Handwaving
-------------------------------------------------------------------------------

It should not be obvious that

$$
    \sum_{n=1}^\infty \frac{1}{n^2} = \frac{\pi^2}{6}
$$

This was first proved by Euler in 1734 by kind of sketchy methods, and it took
a few years to make the proof rigorous. Nevertheless, I'm presenting the sketchy
proof.

To prove this is true, we're going to use the Taylor series expansion for
$$\sin(x)$$. For all $$x$$, the sine can be written as

$$
    \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots
$$

Divide through by $$x$$ to get

$$
    \frac{\sin(x)}{x} = 1 - \frac{x^2}{3!} + \frac{x^4}{5!} - \cdots
$$

(If you don't know what Taylor series are, take this on faith, it's not worth
explaining in this post.)

The idea Euler used was to treat $$\sin$$ as an infinite degree polynomial.
Any polynomial $$p(x)$$ with roots $$r_1,\ldots, r_n$$ can be written as

$$
    p(x) = a(x-r_1)(x-r_2)\cdots(x-r_n)
$$

where $$a$$ is some constant. But for this proof, we're using a different
form. Divide each term by $$-r_i$$ to get

$$
    p\left(x\right) = a'\left(1 - \frac{x}{r_1}\right)\left(1 - \frac{x}{r_2}\right)\cdots\left(1-\frac{x}{r_n}\right)
$$

where again, $$a'$$ is some constant.
Assuming this works for functions with infinitely many roots, note
$$\sin(x)/x = 0$$
at $$x = \pm \pi, \pm 2\pi, \pm 3\pi, \ldots$$.

$$
    \frac{\sin(x)}{x} = a'\left(1-\frac{x}{\pi}\right)\left(1+\frac{x}{\pi}\right)\left(1-\frac{x}{2\pi}\right)\left(1+\frac{x}{2\pi}\right)\cdots
$$

To make the constant term match up, $$a' = 1$$.
(Try converting this to the $$a(x-r_1)(x-r_2)\cdots$$ form and
you'll see why this proof is sketchy.)

By grouping up terms, we get

$$
    \frac{\sin(x)}{x} = \left(1-\frac{x^2}{\pi^2}\right)\left(1-\frac{x^2}{4\pi^2}\right)\left(1-\frac{x^2}{9\pi^2}\right)\cdots
$$

Now, compare the coefficient of $$x^2$$ from this product to the coefficient
in the Taylor series. To get $$x^2$$, we have to choose $$x^2/(n^2\pi^2)$$
exactly once, and choose $$1$$ from the rest. This gives

$$
    -\frac{1}{3!}x^2 = \sum_{n=1}^\infty -\frac{x^2}{n^2\pi^2}
$$

Which gives the final answer of

$$
   \sum_{n=1}^\infty \frac{1}{n^2} = \frac{\pi^2}{6}
$$

MOTIVATION HERE

This sum of reciprocals is a specific case of the [Riemann zeta function](https://en.wikipedia.org/wiki/Riemann_zeta_function),
defined as

$$
    \zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s}
$$

It turns out that studying this function for varying $$s$$ has deep connections
to number theory. I don't know analytic number theory (or analysis, really), so
I can't explain why that's true. But if you consider that we started with
relatively prime numbers and got to sums of reciprocals of squares, I think
it's reasonable to believe there is something going on here.


Pi by Prime Products
---------------------------------------------------------------------------

Finally, I'll close with a fun identity that relates the prime numbers to $$\pi$$.
Every odd prime $$p$$ is either $$1 \text{ mod } 4$$ or $$3 \text{ mod } 4$$. Take the
negative reciprocal if it's $$1 \text{ mod } 4$$ and the positive reciprocal if it's
$$3 \text{ mod } 4$$. Add $$1$$, take the product over all primes, and you get

$$
    \frac{4}{\pi} = \left(1+\frac{1}{3}\right)\left(1-\frac{1}{5}\right)\left(1+\frac{1}{7}\right)\left(1+\frac{1}{11}\right)\cdots
$$

CITE http://www.cut-the-knot.org/proofs/AfterEulerProduct.shtml

The proof for this is going to borrow elements from both previous
sections. First, take the reciprocal.

$$
    \frac{1}{1+\frac{1}{3}}\cdot
                    \frac{1}{1-\frac{1}{5}}\cdot
                    \frac{1}{1+\frac{1}{7}}\cdot
                    \frac{1}{1+\frac{1}{11}}
$$

Again, replace each term with an infinite series

$$
    \prod_{p \equiv 1 \text{ mod }4} \left(1 +\frac{1}{p} + \frac{1}{p^2}+\cdots\right)
    \prod_{p \equiv 3 \text{ mod }4} \left(1 - \frac{1}{p} + \frac{1}{p^2}-\cdots\right)
$$

And again, expand out this infinite product. Ignoring the signs, this is
exactly the same as the relatively prime product, except it doesn't have
an infinite series for $$2$$. Expanding this product will give every odd
number.

Now, consider the sign. When designed this way, a term $$1/n$$ is positive if
$$n$$ is the product of an even number of $$3\text{ mod } 4$$ primes.
(They don't have to be distinct, the even powers automatically get a
+ sign in the infinite series.) The term is negative otherwise.

If you multiply an even number of $$3\text{ mod }4$$ primes, you
get $$3^{2k} \equiv 9^k \equiv 1 \text{ mod } 4$$. If you multiply
an odd number of those primes, you get $$3 \text{ mod } 4$$. So,
the sign is negative at every other odd number, and the product
expands to

$$
    1 - \frac{1}{3} + \frac{1}{5} - \frac{1}{7} + \frac{1}{9} - \cdots
$$

Out comes the [Leibniz formula for $$\pi$$](https://en.wikipedia.org/wiki/Leibniz_formula_for_%CF%80), derivable
by Taylor series on $$\arctan(1)$$.

$$
    \frac{\pi}{4} =
    \frac{1}{1+\frac{1}{3}}\cdot
                    \frac{1}{1-\frac{1}{5}}\cdot
                    \frac{1}{1+\frac{1}{7}}\cdot
                    \frac{1}{1+\frac{1}{11}}
$$

$$
    \frac{4}{\pi} = \left(1+\frac{1}{3}\right)\left(1-\frac{1}{5}\right)\left(1+\frac{1}{7}\right)\left(1+\frac{1}{11}\right)\cdots
$$

(I love this factoring trick so much. It's great, even if it's difficult
to apply on other problems.)


Oh My! That's All, Folks!
-------------------------------------------------------------------------------

That's all I've got. Hope you liked this math diversion, and less
mathy content is coming soon. If plans work out properly. We'll see.
